# –ê—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∞ —ñ–≥—Ä–æ–≤–æ–≥–æ –¥–≤–∏–≥—É–Ω–∞ PacMan Console

## üéÆ –ó–∞–≥–∞–ª—å–Ω–∏–π –æ–≥–ª—è–¥

–¶–µ–π —ñ–≥—Ä–æ–≤–∏–π –¥–≤–∏–≥—É–Ω –ø–æ–±—É–¥–æ–≤–∞–Ω–∏–π –∑–∞ –ø—Ä–∏–Ω—Ü–∏–ø–æ–º **Entity-Component System (ECS)** –∑ –∫–æ–Ω—Å–æ–ª—å–Ω–∏–º —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–æ–º. –í—ñ–Ω –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î —Ç–∞–∫—Ç–æ–≤—É —Å–∏—Å—Ç–µ–º—É –æ–Ω–æ–≤–ª–µ–Ω—å —Ç–∞ —Å—ñ—Ç—á–∞—Å—Ç—É —Å—Ç—Ä—É–∫—Ç—É—Ä—É –¥–ª—è –∑–±–µ—Ä—ñ–≥–∞–Ω–Ω—è –æ–±'—î–∫—Ç—ñ–≤.

## üìã –û—Å–Ω–æ–≤–Ω—ñ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∏

### 1. **–¢–æ—á–∫–∞ –≤—Ö–æ–¥—É - Program.cs**
```csharp
static void Main(string[] args)
{
    new GameController().Run();
}
```
- –ó–∞–ø—É—Å–∫–∞—î –≥–æ–ª–æ–≤–Ω–∏–π –∫–æ–Ω—Ç—Ä–æ–ª–µ—Ä –≥—Ä–∏
- –ü—Ä–æ—Å—Ç–∏–π entry point –±–µ–∑ –¥–æ–¥–∞—Ç–∫–æ–≤–æ—ó –ª–æ–≥—ñ–∫–∏

### 2. **–ì–æ–ª–æ–≤–Ω–∏–π –∫–æ–Ω—Ç—Ä–æ–ª–µ—Ä - GameController.cs**
```csharp
public void Run()
{
    while (true)
    {
        Intro() ‚Üí DifficultyScene() ‚Üí GameScene() ‚Üí [Finish/Dead]Scene()
    }
}
```

**–û—Å–Ω–æ–≤–Ω–∏–π —Ü–∏–∫–ª –≥—Ä–∏:**
1. **Intro Scene** - –≥–æ–ª–æ–≤–Ω–µ –º–µ–Ω—é
2. **Difficulty Scene** - –≤–∏–±—ñ—Ä —Å–∫–ª–∞–¥–Ω–æ—Å—Ç—ñ
3. **Game Scene** - –æ—Å–Ω–æ–≤–Ω–∞ –≥—Ä–∞ –∑ —Ç–∞–∫—Ç–æ–≤–∏–º —Ü–∏–∫–ª–æ–º
4. **End Scenes** - –µ–∫—Ä–∞–Ω–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—è (–ø–µ—Ä–µ–º–æ–≥–∞/–ø–æ—Ä–∞–∑–∫–∞)

**–¢–∞–∫—Ç–æ–≤–∏–π —Ü–∏–∫–ª:**
```csharp
while (s.transition == TransitionType.None)
{
    sw.Start();
    s.Tick();                    // –û–Ω–æ–≤–ª–µ–Ω–Ω—è –ª–æ–≥—ñ–∫–∏
    sw.Stop();
    
    // –ö–æ–Ω—Ç—Ä–æ–ª—å FPS (400ms –º—ñ–∂ –∫–∞–¥—Ä–∞–º–∏)
    var target = GameLoopDelay - elapsed;
    Task.Delay(target).Wait();
}
```

### 3. **–Ü–≥—Ä–æ–≤–∞ —Å—Ü–µ–Ω–∞ - GameScene.cs**

#### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–∏—Ö:
```csharp
public LinkedList<EntityBase>[,] grid;  // –°—ñ—Ç–∫–∞ 21x15
```
- **2D –º–∞—Å–∏–≤** –∑–≤'—è–∑–∞–Ω–∏—Ö —Å–ø–∏—Å–∫—ñ–≤
- –ö–æ–∂–Ω–∞ –∫–ª—ñ—Ç–∏–Ω–∫–∞ –º–æ–∂–µ –º—ñ—Å—Ç–∏—Ç–∏ **–º–Ω–æ–∂–∏–Ω—É –æ–±'—î–∫—Ç—ñ–≤**
- –†–æ–∑–º—ñ—Ä: 21x15 –∫–ª—ñ—Ç–∏–Ω–æ–∫ (–∑–≥—ñ–¥–Ω–æ Constant.cs)

#### –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Ä—ñ–≤–Ω—è:
```csharp
public void Load(string filePath)
{
    // –ß–∏—Ç–∞—î map.txt
    // –°—Ç–≤–æ—Ä—é—î –æ–±'—î–∫—Ç–∏ –∑–∞ —Å–∏–º–≤–æ–ª–∞–º–∏:
    // 'C' ‚Üí Player, '@' ‚Üí Ghost, '?' ‚Üí Wall, '.' ‚Üí Score, ' ' ‚Üí Space
}
```

#### –û—Å–Ω–æ–≤–Ω–∏–π —Ü–∏–∫–ª –æ–Ω–æ–≤–ª–µ–Ω–Ω—è:
```csharp
public void Tick()
{
    // 1. –û–Ω–æ–≤–ª–µ–Ω–Ω—è –®–Ü –∫–æ–º—É–Ω—ñ–∫–∞—Ü—ñ—ó
    GhostCommunication.UpdateTick();
    
    // 2. –ó–±—ñ—Ä –≤—Å—ñ—Ö –æ–±'—î–∫—Ç—ñ–≤ –≤ —á–µ—Ä–≥—É
    var executionQueue = new Queue<EntityBase>();
    for (y, x in grid)
        executionQueue.Enqueue(all entities);
    
    // 3. –í–∏–∫–æ–Ω–∞–Ω–Ω—è Update() –¥–ª—è –∫–æ–∂–Ω–æ–≥–æ –æ–±'—î–∫—Ç–∞
    while (queue not empty)
        item.Update();
    
    // 4. –†–µ–Ω–¥–µ—Ä–∏–Ω–≥
    renderer.Render(grid);
}
```

**üéØ –ö–ª—é—á–æ–≤–∞ –æ—Å–æ–±–ª–∏–≤—ñ—Å—Ç—å:** –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è —á–µ—Ä–≥–∏ –∑–∞–ø–æ–±—ñ–≥–∞—î –ø–æ–¥–≤—ñ–π–Ω–æ–º—É –æ–Ω–æ–≤–ª–µ–Ω–Ω—é –æ–±'—î–∫—Ç—ñ–≤, —è–∫—ñ —Ä—É—Ö–∞—é—Ç—å—Å—è –ø—ñ–¥ —á–∞—Å —Ç–æ–≥–æ –∂ —Ç—ñ–∫—É.

### 4. **–ë–∞–∑–æ–≤–∏–π –æ–±'—î–∫—Ç - EntityBase.cs**

#### –ê–±—Å—Ç—Ä–∞–∫—Ç–Ω–∏–π –∫–ª–∞—Å –¥–ª—è –≤—Å—ñ—Ö —ñ–≥—Ä–æ–≤–∏—Ö –æ–±'—î–∫—Ç—ñ–≤:
```csharp
public abstract class EntityBase
{
    // –ü–æ–∑–∏—Ü—ñ—è
    public int x, y { get; private set; }
    
    // –í—ñ–∑—É–∞–ª—å–Ω–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–Ω—è
    public Pixel pixel;
    public abstract char character;
    
    // –õ–æ–≥—ñ–∫–∞
    public abstract void Update();
    
    // –î–æ—Å—Ç—É–ø –¥–æ —ñ–≥—Ä–æ–≤–æ–≥–æ —Å–≤—ñ—Ç—É
    public EntityBase GetEntityInDirection(Direction, distance);
    public LinkedList<EntityBase>[,] gridView;
}
```

#### –°–∏—Å—Ç–µ–º–∞ —Ä—É—Ö—É:
```csharp
public void Move(int x, int y)
{
    // –í–∏–¥–∞–ª—è—î –∑ –ø–æ—Ç–æ—á–Ω–æ—ó –ø–æ–∑–∏—Ü—ñ—ó
    scene.grid[this.y, this.x].RemoveFirst();
    
    // –î–æ–¥–∞—î –≤ –Ω–æ–≤—É –ø–æ–∑–∏—Ü—ñ—é
    scene.grid[y, x].AddFirst(this);
    
    // –û–Ω–æ–≤–ª—é—î –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∏
    this.x = x; this.y = y;
}
```

### 5. **–†–µ–Ω–¥–µ—Ä–∏–Ω–≥ - Renderer.cs**

#### –ö–æ–Ω—Å–æ–ª—å–Ω–∏–π —Ä–µ–Ω–¥–µ—Ä–µ—Ä –∑ –º–∞—Å—à—Ç–∞–±—É–≤–∞–Ω–Ω—è–º:
```csharp
// –ë–∞–∑–æ–≤–∏–π —Ä–æ–∑–º—ñ—Ä: 21x15
// –ú–∞—Å—à—Ç–∞–±: x4 –ø–æ –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—ñ, x2 –ø–æ –≤–µ—Ä—Ç–∏–∫–∞–ª—ñ
// –§—ñ–Ω–∞–ª—å–Ω–∏–π —Ä–æ–∑–º—ñ—Ä –∫–æ–Ω—Å–æ–ª—ñ: 84x30
```

#### –ü—Ä–æ—Ü–µ—Å —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥—É:
```csharp
public void Render(LinkedList<EntityBase>[,] grid)
{
    for (y, x in grid)
    {
        var topEntity = grid[y, x].First.Value;  // –í–µ—Ä—Ö–Ω—ñ–π –æ–±'—î–∫—Ç
        
        // –í—Å—Ç–∞–Ω–æ–≤–ª—é—î –∫–æ–ª—å–æ—Ä–∏
        Console.ForegroundColor = topEntity.pixel.ForegroundColor;
        Console.BackgroundColor = topEntity.pixel.BackgroundColor;
        
        // –í–∏–≤–æ–¥–∏—Ç—å —Å–∏–º–≤–æ–ª –∑ –º–∞—Å—à—Ç–∞–±—É–≤–∞–Ω–Ω—è–º
        Console.Write(topEntity.character);
    }
}
```

**üé® –í—ñ–∑—É–∞–ª—å–Ω–∞ —Å–∏—Å—Ç–µ–º–∞:**
- –ö–æ–∂–µ–Ω –æ–±'—î–∫—Ç –º–∞—î `Pixel` –∑ –∫–æ–ª—å–æ—Ä–∞–º–∏ —Ñ–æ–Ω—É —Ç–∞ —Ç–µ–∫—Å—Ç—É
- –†–µ–Ω–¥–µ—Ä–∏—Ç—å—Å—è —Ç—ñ–ª—å–∫–∏ **–≤–µ—Ä—Ö–Ω—ñ–π –æ–±'—î–∫—Ç** –∑—ñ —Å—Ç–µ–∫—É –≤ –∫–æ–∂–Ω—ñ–π –∫–ª—ñ—Ç–∏–Ω—Ü—ñ
- –ú–∞—Å—à—Ç–∞–±—É–≤–∞–Ω–Ω—è –¥–ª—è –∫—Ä–∞—â–æ—ó –≤–∏–¥–∏–º–æ—Å—Ç—ñ

### 6. **–°–∏—Å—Ç–µ–º–∞ –≤–≤–æ–¥—É - Input.cs**

#### –ö–ª–∞–≤—ñ–∞—Ç—É—Ä–Ω–∏–π –≤–≤—ñ–¥:
```csharp
public InputStatus GetInput()
{
    // –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î System.Windows.Input.Keyboard
    // –ü–µ—Ä–µ–≤—ñ—Ä—è—î —Å—Ç—Ä—ñ–ª–∫–∏: Up, Down, Left, Right
    // –ü–æ–≤–µ—Ä—Ç–∞—î –ø–æ—Ç–æ—á–Ω–∏–π —Å—Ç–∞–Ω (–Ω–µ –ø–æ–¥—ñ—ó)
}
```

## üèóÔ∏è –ê—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–Ω—ñ –ø—Ä–∏–Ω—Ü–∏–ø–∏

### 1. **Entity-Component Pattern**
- `EntityBase` - –±–∞–∑–æ–≤–∞ —Å—É—Ç–Ω—ñ—Å—Ç—å
- –ö–æ–∂–µ–Ω —Ç–∏–ø (Player, Ghost, Wall) –Ω–∞—Å–ª—ñ–¥—É—î —ñ —Ä–µ–∞–ª—ñ–∑—É—î —Å–≤–æ—é –ª–æ–≥—ñ–∫—É
- –ö–æ–º–ø–æ–Ω–µ–Ω—Ç–∏: –ø–æ–∑–∏—Ü—ñ—è, –≤—ñ–∑—É–∞–ª, –ø–æ–≤–µ–¥—ñ–Ω–∫–∞

### 2. **Grid-Based World**
- –°–≤—ñ—Ç —Ä–æ–∑–¥—ñ–ª–µ–Ω–∏–π –Ω–∞ –¥–∏—Å–∫—Ä–µ—Ç–Ω—ñ –∫–ª—ñ—Ç–∏–Ω–∫–∏
- –ö–æ–∂–Ω–∞ –∫–ª—ñ—Ç–∏–Ω–∫–∞ - —Å—Ç–µ–∫ –æ–±'—î–∫—Ç—ñ–≤ (LinkedList)
- –†—É—Ö –≤—ñ–¥–±—É–≤–∞—î—Ç—å—Å—è –º—ñ–∂ –∫–ª—ñ—Ç–∏–Ω–∫–∞–º–∏

### 3. **Tick-Based Updates**
- –°–∏–Ω—Ö—Ä–æ–Ω–Ω—ñ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è –≤—Å—ñ—Ö –æ–±'—î–∫—Ç—ñ–≤
- –§—ñ–∫—Å–æ–≤–∞–Ω–∏–π FPS (400ms –º—ñ–∂ –∫–∞–¥—Ä–∞–º–∏)
- –î–µ—Ç–µ—Ä–º—ñ–Ω—ñ—Å—Ç–∏—á–Ω–∞ –ª–æ–≥—ñ–∫–∞

### 4. **State Machine**
- –°—Ü–µ–Ω–∏ —è–∫ —Å—Ç–∞–Ω–∏: Intro ‚Üí Difficulty ‚Üí Game ‚Üí End
- –ü–µ—Ä–µ—Ö–æ–¥–∏ —á–µ—Ä–µ–∑ TransitionType
- –¶–∏–∫–ª—ñ—á–Ω—ñ—Å—Ç—å –≥—Ä–∏ (–ø–æ–≤–µ—Ä–Ω–µ–Ω–Ω—è –¥–æ Intro)

## üé≤ –Ü–≥—Ä–æ–≤—ñ –æ–±'—î–∫—Ç–∏

### **Player (–ì—Ä–∞–≤–µ—Ü—å)**
- –°–∏–º–≤–æ–ª: 'C'
- –ö–æ–ª—ñ—Ä: DarkYellow
- –õ–æ–≥—ñ–∫–∞: –ö–µ—Ä—É–≤–∞–Ω–Ω—è –∫–ª–∞–≤—ñ–∞—Ç—É—Ä–æ—é, –∑–±—ñ—Ä –æ—á–æ–∫

### **Ghost (–ü—Ä–∏–≤–∏–¥)**
- –°–∏–º–≤–æ–ª: '@'
- –ö–æ–ª—ñ—Ä: Magenta
- –õ–æ–≥—ñ–∫–∞: –°–∫–ª–∞–¥–Ω–∞ –®–Ü —Å–∏—Å—Ç–µ–º–∞ (–ø–∞—Ç—Ä—É–ª—é–≤–∞–Ω–Ω—è, –ø–æ–ª—é–≤–∞–Ω–Ω—è, –±–ª–æ–∫—É–≤–∞–Ω–Ω—è)

### **Wall (–°—Ç—ñ–Ω–∞)**
- –°–∏–º–≤–æ–ª: '?'
- –õ–æ–≥—ñ–∫–∞: –°—Ç–∞—Ç–∏—á–Ω–∏–π –æ–±'—î–∫—Ç, –±–ª–æ–∫—É—î —Ä—É—Ö

### **Score (–û—á–∫–æ)**
- –°–∏–º–≤–æ–ª: '.'
- –õ–æ–≥—ñ–∫–∞: –ó–Ω–∏—â—É—î—Ç—å—Å—è –ø—Ä–∏ –∑–±–æ—Ä—ñ, —Ä–∞—Ö—É—î –ø—Ä–æ–≥—Ä–µ—Å

### **Space (–ü—É—Å—Ç–æ—Ç–∞)**
- –°–∏–º–≤–æ–ª: ' '
- –õ–æ–≥—ñ–∫–∞: –§–æ–Ω–æ–≤–∞ –∫–ª—ñ—Ç–∏–Ω–∫–∞, –∑–∞–≤–∂–¥–∏ –ø—Ä–∏—Å—É—Ç–Ω—è

## ‚ö° –û–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—ó —Ç–∞ –æ—Å–æ–±–ª–∏–≤–æ—Å—Ç—ñ

### 1. **Execution Queue**
- –ó–∞–ø–æ–±—ñ–≥–∞—î –ø–æ–¥–≤—ñ–π–Ω–æ–º—É –æ–Ω–æ–≤–ª–µ–Ω–Ω—é –æ–±'—î–∫—Ç—ñ–≤
- –ì–∞—Ä–∞–Ω—Ç—É—î –ø–æ—Ä—è–¥–æ–∫ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è

### 2. **Grid View**
- –ö–æ–∂–µ–Ω –æ–±'—î–∫—Ç –º–∞—î –¥–æ—Å—Ç—É–ø –¥–æ –∫–æ–ø—ñ—ó —Å—ñ—Ç–∫–∏
- –ë–µ–∑–ø–µ—á–Ω–∏–π –¥–æ—Å—Ç—É–ø –¥–æ —Å—É—Å—ñ–¥–Ω—ñ—Ö –æ–±'—î–∫—Ç—ñ–≤

### 3. **–ú–∞—Å—à—Ç–∞–±—É–≤–∞–Ω–Ω—è —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥—É**
- –ü–æ–∫—Ä–∞—â—É—î —á–∏—Ç–∞–Ω—ñ—Å—Ç—å –Ω–∞ –∫–æ–Ω—Å–æ–ª—ñ
- –ù–∞–ª–∞—à—Ç–æ–≤—É—î—Ç—å—Å—è —á–µ—Ä–µ–∑ –∫–æ–Ω—Å—Ç–∞–Ω—Ç–∏

### 4. **–°–∏—Å—Ç–µ–º–∞ –ø–µ—Ä–µ—Ö–æ–¥—ñ–≤**
- –ï–ª–µ–≥–∞–Ω—Ç–Ω–µ –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—è –≥—Ä–∏
- –ú–æ–∂–ª–∏–≤—ñ—Å—Ç—å —Ä—ñ–∑–Ω–∏—Ö –∫—ñ–Ω—Ü—ñ–≤–æ–∫

## üîß –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è

### –ö–æ–Ω—Å—Ç–∞–Ω—Ç–∏ (Constant.cs):
```csharp
WindowXSize = 21      // –®–∏—Ä–∏–Ω–∞ —ñ–≥—Ä–æ–≤–æ–≥–æ –ø–æ–ª—è
WindowYSize = 15      // –í–∏—Å–æ—Ç–∞ —ñ–≥—Ä–æ–≤–æ–≥–æ –ø–æ–ª—è
WindowXScale = 4      // –ú–∞—Å—à—Ç–∞–± –ø–æ X
WindowYScale = 2      // –ú–∞—Å—à—Ç–∞–± –ø–æ Y
GameLoopDelay = 400   // –ó–∞—Ç—Ä–∏–º–∫–∞ –º—ñ–∂ —Ç—ñ–∫–∞–º–∏ (–º—Å)
```

### –°–∏–º–≤–æ–ª–∏ –æ–±'—î–∫—Ç—ñ–≤:
```csharp
PlayerChar = 'C'      // –ü–∞–∫–º–µ–Ω
GhostChar = '@'       // –ü—Ä–∏–≤–∏–¥
WallChar = '?'        // –°—Ç—ñ–Ω–∞
ScoreChar = '.'       // –û—á–∫–æ
SpaceChar = ' '       // –ü—É—Å—Ç–æ—Ç–∞
```

## üéØ –ü–µ—Ä–µ–≤–∞–≥–∏ –∞—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∏

‚úÖ **–ü—Ä–æ—Å—Ç–æ—Ç–∞** - –ó—Ä–æ–∑—É–º—ñ–ª–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞  
‚úÖ **–†–æ–∑—à–∏—Ä—é–≤–∞–Ω—ñ—Å—Ç—å** - –õ–µ–≥–∫–æ –¥–æ–¥–∞–≤–∞—Ç–∏ –Ω–æ–≤—ñ –æ–±'—î–∫—Ç–∏  
‚úÖ **–î–µ—Ç–µ—Ä–º—ñ–Ω—ñ–∑–º** - –ü–µ—Ä–µ–¥–±–∞—á—É–≤–∞–Ω–∞ –ø–æ–≤–µ–¥—ñ–Ω–∫–∞  
‚úÖ **–ü—Ä–æ–¥—É–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å** - –ï—Ñ–µ–∫—Ç–∏–≤–Ω–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –ø–∞–º'—è—Ç—ñ  
‚úÖ **–ú–æ–¥—É–ª—å–Ω—ñ—Å—Ç—å** - –†–æ–∑–¥—ñ–ª–µ–Ω—ñ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞–ª—å–Ω–æ—Å—Ç—ñ  

–¶–µ–π –¥–≤–∏–≥—É–Ω —ñ–¥–µ–∞–ª—å–Ω–æ –ø—ñ–¥—Ö–æ–¥–∏—Ç—å –¥–ª—è 2D —ñ–≥–æ—Ä –∑ —Å—ñ—Ç—á–∞—Å—Ç–æ—é —Å—Ç—Ä—É–∫—Ç—É—Ä–æ—é —Ç–∞ –ø–æ–∫—Ä–æ–∫–æ–≤–æ—é –ª–æ–≥—ñ–∫–æ—é!
